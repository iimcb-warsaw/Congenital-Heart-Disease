# Determine the conservation between genome-wide aligned nucleotides pairs (hg38 .Vs. danRer11) Computation of conservation scores using phylofit and phastCons programs

# Link to the pairwise alignments : hg38. Vs. danRer11 genomic assemblies 

ftp://ftp.ensembl.org/pub/release-96/maf/ensembl-compara/pairwise_alignments/

##### Multiple Alignment Format () for alignment blocks from Chromosome 1 in reference genome sequence (hg38) ####

# Firstly, modify the format of MAF files - downloaded from ensembl to make them compatible with PHAST software


ls hsap_grch38.v.drer_grcz11.lastz_net.chr1_*.maf | sort -V | xargs cat > chr1_all.maf
sed -i -e 's/a# id/#id/g' chr1_all.maf
sed -i -e 's/ score/a score/g' chr1_all.maf
sed -i -e 's/ a/a/g' chr1_all.maf
grep "DB CONNECT    :" chr1_all.maf
sed -i -e 's/DB CONNECT    :/# DB CONNECT    :/g' chr1_all.maf

# Identify conserved elements or compute conservation scores

# PhyloFit: Fits one or more tree models to a multiple alignment of DNA sequences by maximum likelihood, using the specified tree topology
#  and substitution model. 

# Fit a phylogenetic model to an alignment of human and zebrafish genomes (chr1 for now)

 phyloFit chr1_all.maf


phastCons --most-conserved  --coding-potential --msa-format MAF chr1_all.maf phyloFit.mod > scores_chr1.bed



